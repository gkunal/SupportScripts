import psycopg2
from decimal import Decimal
from datetime import date, datetime, time, timedelta, datetime
import time
import requests
import json
import csv
import sys
import os
from calendar import timegm
import logging
import statistics

BASE_URL = "https://rest.coinapi.io/v1/exchangerate/ETH/USD/history";
apiKey = '3E05FB4F-7E0B-474C-8EF6-E315FD390EA9'

def sendRequest(start_utc_time, end_utc_time, block_number):
  logging.info("Start Time::%s", start_utc_time)
  logging.info("End Time:::%s", end_utc_time)
   
  global json_data
  try:     
     
     logging.info("Sending Request to fetch data start:%s end:%s and for block_number=%s",start_utc_time,end_utc_time,block_number)
     payload = {'period_id':'1MIN', 'time_start': start_utc_time, 'time_end': end_utc_time, 'apikey': apiKey}
  
     response = requests.get(BASE_URL, params=payload)
     json_data = json.loads(response.text)     
     logging.info("JSON:::%s", json_data)
     
  except:
     json_data = {}
     logging.error("Failed to get data from coinbase Start:%s End:%s BlockNumber:", start_utc_time, end_utc_time, block_number)
     logging.error("Oops! %s occurred", sys.exc_info()[0])
     return False
  return True

def insertToDatabase(block_number, block_timestamp, compareval):
  
  if (json_data):
     converted_to = 'USD'
     
     #block_epoch_time = timegm(time.strptime((str(block_timestamp)[:16]), "%Y-%m-%dT%H:%M"))
          
     current = []
     for data in json_data:
         str1 = data["time_period_start"][0:19]
         
         if(str1 == compareval):
             #logging.info("High:::%s, Low:::%s:::block_timestamp:::%s,Actual:::%s", data["rate_high"], data["rate_low"], block_timestamp, data["time_period_start"])
             logging.info("Match Found:::%s --> %s", block_timestamp, block_number)
             current = data
             break
             
     if(current):
        #logging.info("Data found for %s and %s", block_number, block_timestamp);
        converted_rate = statistics.mean([current["rate_high"], current["rate_low"]])
        insert_query = 'insert into eth_rates (conversion_rate, converted_at, converted_to, block_number) values (%s, %s, %s, %s) on conflict (block_number,converted_to) do nothing;'             
        cur = conn.cursor()  
        record = (converted_rate, block_timestamp, converted_to, block_number)
        cur.execute(insert_query, record)
        conn.commit()
     else:
        logging.info("No data found for block number: %s and time: %s", block_number, block_timestamp)      
  else:
     logging.info("Json data is blank. BlockNumber:%s BlockTime:", block_number, block_timestamp)     

def process_file(csvfilename):
  t_start = time.time()
  t_process_csv = 0
  start_utc_time = datetime.now()
  end_utc_time = datetime.now()
  with open(csvfilename, 'r') as f:
    csv.field_size_limit(2147483647)
    csv_f = csv.reader(f)
    set_addresses = set()
    for counter, row in enumerate(csv_f):
         block_timestamp = datetime.strptime((str(row[1])[:16]), "%Y-%m-%d %H:%M")      
         
         if(block_timestamp.timestamp() < start_utc_time.timestamp() or block_timestamp.timestamp() > end_utc_time.timestamp()):
         #if(len(json_data) > 0):
            start_utc_time = datetime.strptime((str(row[1])[:16]), "%Y-%m-%d %H:%M")
            end_utc_time = start_utc_time + timedelta(hours=1)
            logging.info("Fetching data for Start:%s End:%s BlockNumber:%s", start_utc_time.isoformat(), end_utc_time.isoformat() ,row[0])
            sendRequest(start_utc_time.isoformat(), end_utc_time.isoformat(), row[0])
         
         insertToDatabase(row[0], row[1], start_utc_time.isoformat())
   
  logging.info("Processing of records are completed")
   
Log_Format = "%(levelname)s %(asctime)s - %(message)s"
csvfilename = '/home/imkunalgandhi_gmail_com/2020-missing-blocks.csv'
logging.basicConfig(filename = '/home/imkunalgandhi_gmail_com/logs_0328.log',
                    filemode = "w",
                    format = Log_Format,
                    level = logging.INFO)
logger = logging.getLogger()
#json_data = [{'time_period_start': '2020-01-30T17:04:00.0000000Z', 'time_period_end': '2020-01-30T17:05:00.0000000Z', 'time_open': '2020-01-30T17:04:00.0000000Z', 'time_close': '2020-01-30T17:04:00.0000000Z', 'rate_open': 177.58949843131228, 'rate_high': 177.58949843131228, 'rate_low': 177.58949843131228, 'rate_close': 177.58949843131228}, {'time_period_start': '2020-01-30T17:05:00.0000000Z', 'time_period_end': '2020-01-30T17:06:00.0000000Z', 'time_open': '2020-01-30T17:05:00.0000000Z', 'time_close': '2020-01-30T17:05:00.0000000Z', 'rate_open': 177.5914563782602, 'rate_high': 177.5914563782602, 'rate_low': 177.5914563782602, 'rate_close': 177.5914563782602}, {'time_period_start': '2020-01-30T17:06:00.0000000Z', 'time_period_end': '2020-01-30T17:07:00.0000000Z', 'time_open': '2020-01-30T17:06:00.0000000Z', 'time_close': '2020-01-30T17:06:00.0000000Z', 'rate_open': 177.82060173368023, 'rate_high': 177.82060173368023, 'rate_low': 177.82060173368023, 'rate_close': 177.82060173368023}, {'time_period_start': '2020-01-30T17:07:00.0000000Z', 'time_period_end': '2020-01-30T17:08:00.0000000Z', 'time_open': '2020-01-30T17:07:00.0000000Z', 'time_close': '2020-01-30T17:07:00.0000000Z', 'rate_open': 178.01341940169635, 'rate_high': 178.01341940169635, 'rate_low': 178.01341940169635, 'rate_close': 178.01341940169635}, {'time_period_start': '2020-01-30T17:08:00.0000000Z', 'time_period_end': '2020-01-30T17:09:00.0000000Z', 'time_open': '2020-01-30T17:08:00.0000000Z', 'time_close': '2020-01-30T17:08:00.0000000Z', 'rate_open': 178.61787622387433, 'rate_high': 178.61787622387433, 'rate_low': 178.61787622387433, 'rate_close': 178.61787622387433}, {'time_period_start': '2020-01-30T17:09:00.0000000Z', 'time_period_end': '2020-01-30T17:10:00.0000000Z', 'time_open': '2020-01-30T17:09:00.0000000Z', 'time_close': '2020-01-30T17:09:00.0000000Z', 'rate_open': 178.69645952600587, 'rate_high': 178.69645952600587, 'rate_low': 178.69645952600587, 'rate_close': 178.69645952600587}, {'time_period_start': '2020-01-30T17:10:00.0000000Z', 'time_period_end': '2020-01-30T17:11:00.0000000Z', 'time_open': '2020-01-30T17:10:00.0000000Z', 'time_close': '2020-01-30T17:10:00.0000000Z', 'rate_open': 178.94085626711566, 'rate_high': 178.94085626711566, 'rate_low': 178.94085626711566, 'rate_close': 178.94085626711566}, {'time_period_start': '2020-01-30T17:11:00.0000000Z', 'time_period_end': '2020-01-30T17:12:00.0000000Z', 'time_open': '2020-01-30T17:11:00.0000000Z', 'time_close': '2020-01-30T17:11:00.0000000Z', 'rate_open': 179.12002938608896, 'rate_high': 179.12002938608896, 'rate_low': 179.12002938608896, 'rate_close': 179.12002938608896}, {'time_period_start': '2020-01-30T17:12:00.0000000Z', 'time_period_end': '2020-01-30T17:13:00.0000000Z', 'time_open': '2020-01-30T17:12:00.0000000Z', 'time_close': '2020-01-30T17:12:00.0000000Z', 'rate_open': 179.17902264398862, 'rate_high': 179.17902264398862, 'rate_low': 179.17902264398862, 'rate_close': 179.17902264398862}, {'time_period_start': '2020-01-30T17:13:00.0000000Z', 'time_period_end': '2020-01-30T17:14:00.0000000Z', 'time_open': '2020-01-30T17:13:00.0000000Z', 'time_close': '2020-01-30T17:13:00.0000000Z', 'rate_open': 178.89966882246668, 'rate_high': 178.89966882246668, 'rate_low': 178.89966882246668, 'rate_close': 178.89966882246668}, {'time_period_start': '2020-01-30T17:14:00.0000000Z', 'time_period_end': '2020-01-30T17:15:00.0000000Z', 'time_open': '2020-01-30T17:14:00.0000000Z', 'time_close': '2020-01-30T17:14:00.0000000Z', 'rate_open': 178.3559041733684, 'rate_high': 178.3559041733684, 'rate_low': 178.3559041733684, 'rate_close': 178.3559041733684}, {'time_period_start': '2020-01-30T17:15:00.0000000Z', 'time_period_end': '2020-01-30T17:16:00.0000000Z', 'time_open': '2020-01-30T17:15:00.0000000Z', 'time_close': '2020-01-30T17:15:00.0000000Z', 'rate_open': 178.3516895620247, 'rate_high': 178.3516895620247, 'rate_low': 178.3516895620247, 'rate_close': 178.3516895620247}, {'time_period_start': '2020-01-30T17:16:00.0000000Z', 'time_period_end': '2020-01-30T17:17:00.0000000Z', 'time_open': '2020-01-30T17:16:00.0000000Z', 'time_close': '2020-01-30T17:16:00.0000000Z', 'rate_open': 178.38754643874384, 'rate_high': 178.38754643874384, 'rate_low': 178.38754643874384, 'rate_close': 178.38754643874384}, {'time_period_start': '2020-01-30T17:17:00.0000000Z', 'time_period_end': '2020-01-30T17:18:00.0000000Z', 'time_open': '2020-01-30T17:17:00.0000000Z', 'time_close': '2020-01-30T17:17:00.0000000Z', 'rate_open': 178.5314623236692, 'rate_high': 178.5314623236692, 'rate_low': 178.5314623236692, 'rate_close': 178.5314623236692}, {'time_period_start': '2020-01-30T17:18:00.0000000Z', 'time_period_end': '2020-01-30T17:19:00.0000000Z', 'time_open': '2020-01-30T17:18:00.0000000Z', 'time_close': '2020-01-30T17:18:00.0000000Z', 'rate_open': 178.9084730928632, 'rate_high': 178.9084730928632, 'rate_low': 178.9084730928632, 'rate_close': 178.9084730928632}, {'time_period_start': '2020-01-30T17:19:00.0000000Z', 'time_period_end': '2020-01-30T17:20:00.0000000Z', 'time_open': '2020-01-30T17:19:00.0000000Z', 'time_close': '2020-01-30T17:19:00.0000000Z', 'rate_open': 179.06527847254983, 'rate_high': 179.06527847254983, 'rate_low': 179.06527847254983, 'rate_close': 179.06527847254983}, {'time_period_start': '2020-01-30T17:20:00.0000000Z', 'time_period_end': '2020-01-30T17:21:00.0000000Z', 'time_open': '2020-01-30T17:20:00.0000000Z', 'time_close': '2020-01-30T17:20:00.0000000Z', 'rate_open': 179.0911296550446, 'rate_high': 179.0911296550446, 'rate_low': 179.0911296550446, 'rate_close': 179.0911296550446}, {'time_period_start': '2020-01-30T17:21:00.0000000Z', 'time_period_end': '2020-01-30T17:22:00.0000000Z', 'time_open': '2020-01-30T17:21:00.0000000Z', 'time_close': '2020-01-30T17:21:00.0000000Z', 'rate_open': 179.12513254425306, 'rate_high': 179.12513254425306, 'rate_low': 179.12513254425306, 'rate_close': 179.12513254425306}, {'time_period_start': '2020-01-30T17:22:00.0000000Z', 'time_period_end': '2020-01-30T17:23:00.0000000Z', 'time_open': '2020-01-30T17:22:00.0000000Z', 'time_close': '2020-01-30T17:22:00.0000000Z', 'rate_open': 179.20888422622258, 'rate_high': 179.20888422622258, 'rate_low': 179.20888422622258, 'rate_close': 179.20888422622258}, {'time_period_start': '2020-01-30T17:23:00.0000000Z', 'time_period_end': '2020-01-30T17:24:00.0000000Z', 'time_open': '2020-01-30T17:23:00.0000000Z', 'time_close': '2020-01-30T17:23:00.0000000Z', 'rate_open': 179.42922825836368, 'rate_high': 179.42922825836368, 'rate_low': 179.42922825836368, 'rate_close': 179.42922825836368}, {'time_period_start': '2020-01-30T17:24:00.0000000Z', 'time_period_end': '2020-01-30T17:25:00.0000000Z', 'time_open': '2020-01-30T17:24:00.0000000Z', 'time_close': '2020-01-30T17:24:00.0000000Z', 'rate_open': 179.37732421384226, 'rate_high': 179.37732421384226, 'rate_low': 179.37732421384226, 'rate_close': 179.37732421384226}, {'time_period_start': '2020-01-30T17:25:00.0000000Z', 'time_period_end': '2020-01-30T17:26:00.0000000Z', 'time_open': '2020-01-30T17:25:00.0000000Z', 'time_close': '2020-01-30T17:25:00.0000000Z', 'rate_open': 179.6150750838621, 'rate_high': 179.6150750838621, 'rate_low': 179.6150750838621, 'rate_close': 179.6150750838621}, {'time_period_start': '2020-01-30T17:26:00.0000000Z', 'time_period_end': '2020-01-30T17:27:00.0000000Z', 'time_open': '2020-01-30T17:26:00.0000000Z', 'time_close': '2020-01-30T17:26:00.0000000Z', 'rate_open': 179.25081198350867, 'rate_high': 179.25081198350867, 'rate_low': 179.25081198350867, 'rate_close': 179.25081198350867}, {'time_period_start': '2020-01-30T17:27:00.0000000Z', 'time_period_end': '2020-01-30T17:28:00.0000000Z', 'time_open': '2020-01-30T17:27:00.0000000Z', 'time_close': '2020-01-30T17:27:00.0000000Z', 'rate_open': 179.39013280131547, 'rate_high': 179.39013280131547, 'rate_low': 179.39013280131547, 'rate_close': 179.39013280131547}, {'time_period_start': '2020-01-30T17:28:00.0000000Z', 'time_period_end': '2020-01-30T17:29:00.0000000Z', 'time_open': '2020-01-30T17:28:00.0000000Z', 'time_close': '2020-01-30T17:28:00.0000000Z', 'rate_open': 179.53250462863224, 'rate_high': 179.53250462863224, 'rate_low': 179.53250462863224, 'rate_close': 179.53250462863224}, {'time_period_start': '2020-01-30T17:29:00.0000000Z', 'time_period_end': '2020-01-30T17:30:00.0000000Z', 'time_open': '2020-01-30T17:29:00.0000000Z', 'time_close': '2020-01-30T17:29:00.0000000Z', 'rate_open': 179.40090654081826, 'rate_high': 179.40090654081826, 'rate_low': 179.40090654081826, 'rate_close': 179.40090654081826}, {'time_period_start': '2020-01-30T17:30:00.0000000Z', 'time_period_end': '2020-01-30T17:31:00.0000000Z', 'time_open': '2020-01-30T17:30:00.0000000Z', 'time_close': '2020-01-30T17:30:00.0000000Z', 'rate_open': 179.3565711736875, 'rate_high': 179.3565711736875, 'rate_low': 179.3565711736875, 'rate_close': 179.3565711736875}, {'time_period_start': '2020-01-30T17:31:00.0000000Z', 'time_period_end': '2020-01-30T17:32:00.0000000Z', 'time_open': '2020-01-30T17:31:00.0000000Z', 'time_close': '2020-01-30T17:31:00.0000000Z', 'rate_open': 179.54303323315887, 'rate_high': 179.54303323315887, 'rate_low': 179.54303323315887, 'rate_close': 179.54303323315887}, {'time_period_start': '2020-01-30T17:32:00.0000000Z', 'time_period_end': '2020-01-30T17:33:00.0000000Z', 'time_open': '2020-01-30T17:32:00.0000000Z', 'time_close': '2020-01-30T17:32:00.0000000Z', 'rate_open': 179.93604777929917, 'rate_high': 179.93604777929917, 'rate_low': 179.93604777929917, 'rate_close': 179.93604777929917}, {'time_period_start': '2020-01-30T17:33:00.0000000Z', 'time_period_end': '2020-01-30T17:34:00.0000000Z', 'time_open': '2020-01-30T17:33:00.0000000Z', 'time_close': '2020-01-30T17:33:00.0000000Z', 'rate_open': 179.94949359697245, 'rate_high': 179.94949359697245, 'rate_low': 179.94949359697245, 'rate_close': 179.94949359697245}, {'time_period_start': '2020-01-30T17:34:00.0000000Z', 'time_period_end': '2020-01-30T17:35:00.0000000Z', 'time_open': '2020-01-30T17:34:00.0000000Z', 'time_close': '2020-01-30T17:34:00.0000000Z', 'rate_open': 179.79305782032546, 'rate_high': 179.79305782032546, 'rate_low': 179.79305782032546, 'rate_close': 179.79305782032546}, {'time_period_start': '2020-01-30T17:35:00.0000000Z', 'time_period_end': '2020-01-30T17:36:00.0000000Z', 'time_open': '2020-01-30T17:35:00.0000000Z', 'time_close': '2020-01-30T17:35:00.0000000Z', 'rate_open': 179.71212407804586, 'rate_high': 179.71212407804586, 'rate_low': 179.71212407804586, 'rate_close': 179.71212407804586}, {'time_period_start': '2020-01-30T17:36:00.0000000Z', 'time_period_end': '2020-01-30T17:37:00.0000000Z', 'time_open': '2020-01-30T17:36:00.0000000Z', 'time_close': '2020-01-30T17:36:00.0000000Z', 'rate_open': 179.72438771881914, 'rate_high': 179.72438771881914, 'rate_low': 179.72438771881914, 'rate_close': 179.72438771881914}, {'time_period_start': '2020-01-30T17:37:00.0000000Z', 'time_period_end': '2020-01-30T17:38:00.0000000Z', 'time_open': '2020-01-30T17:37:00.0000000Z', 'time_close': '2020-01-30T17:37:00.0000000Z', 'rate_open': 179.7387044848802, 'rate_high': 179.7387044848802, 'rate_low': 179.7387044848802, 'rate_close': 179.7387044848802}, {'time_period_start': '2020-01-30T17:38:00.0000000Z', 'time_period_end': '2020-01-30T17:39:00.0000000Z', 'time_open': '2020-01-30T17:38:00.0000000Z', 'time_close': '2020-01-30T17:38:00.0000000Z', 'rate_open': 179.82105382688744, 'rate_high': 179.82105382688744, 'rate_low': 179.82105382688744, 'rate_close': 179.82105382688744}, {'time_period_start': '2020-01-30T17:39:00.0000000Z', 'time_period_end': '2020-01-30T17:40:00.0000000Z', 'time_open': '2020-01-30T17:39:00.0000000Z', 'time_close': '2020-01-30T17:39:00.0000000Z', 'rate_open': 179.83102232045704, 'rate_high': 179.83102232045704, 'rate_low': 179.83102232045704, 'rate_close': 179.83102232045704}, {'time_period_start': '2020-01-30T17:40:00.0000000Z', 'time_period_end': '2020-01-30T17:41:00.0000000Z', 'time_open': '2020-01-30T17:40:00.0000000Z', 'time_close': '2020-01-30T17:40:00.0000000Z', 'rate_open': 179.4953672256535, 'rate_high': 179.4953672256535, 'rate_low': 179.4953672256535, 'rate_close': 179.4953672256535}, {'time_period_start': '2020-01-30T17:41:00.0000000Z', 'time_period_end': '2020-01-30T17:42:00.0000000Z', 'time_open': '2020-01-30T17:41:00.0000000Z', 'time_close': '2020-01-30T17:41:00.0000000Z', 'rate_open': 179.054412902682, 'rate_high': 179.054412902682, 'rate_low': 179.054412902682, 'rate_close': 179.054412902682}, {'time_period_start': '2020-01-30T17:42:00.0000000Z', 'time_period_end': '2020-01-30T17:43:00.0000000Z', 'time_open': '2020-01-30T17:42:00.0000000Z', 'time_close': '2020-01-30T17:42:00.0000000Z', 'rate_open': 179.13782440740516, 'rate_high': 179.13782440740516, 'rate_low': 179.13782440740516, 'rate_close': 179.13782440740516}, {'time_period_start': '2020-01-30T17:43:00.0000000Z', 'time_period_end': '2020-01-30T17:44:00.0000000Z', 'time_open': '2020-01-30T17:43:00.0000000Z', 'time_close': '2020-01-30T17:43:00.0000000Z', 'rate_open': 178.9734298993259, 'rate_high': 178.9734298993259, 'rate_low': 178.9734298993259, 'rate_close': 178.9734298993259}, {'time_period_start': '2020-01-30T17:44:00.0000000Z', 'time_period_end': '2020-01-30T17:45:00.0000000Z', 'time_open': '2020-01-30T17:44:00.0000000Z', 'time_close': '2020-01-30T17:44:00.0000000Z', 'rate_open': 178.86397915798713, 'rate_high': 178.86397915798713, 'rate_low': 178.86397915798713, 'rate_close': 178.86397915798713}, {'time_period_start': '2020-01-30T17:45:00.0000000Z', 'time_period_end': '2020-01-30T17:46:00.0000000Z', 'time_open': '2020-01-30T17:45:00.0000000Z', 'time_close': '2020-01-30T17:45:00.0000000Z', 'rate_open': 178.6744243980902, 'rate_high': 178.6744243980902, 'rate_low': 178.6744243980902, 'rate_close': 178.6744243980902}, {'time_period_start': '2020-01-30T17:46:00.0000000Z', 'time_period_end': '2020-01-30T17:47:00.0000000Z', 'time_open': '2020-01-30T17:46:00.0000000Z', 'time_close': '2020-01-30T17:46:00.0000000Z', 'rate_open': 178.7509729026394, 'rate_high': 178.7509729026394, 'rate_low': 178.7509729026394, 'rate_close': 178.7509729026394}, {'time_period_start': '2020-01-30T17:47:00.0000000Z', 'time_period_end': '2020-01-30T17:48:00.0000000Z', 'time_open': '2020-01-30T17:47:00.0000000Z', 'time_close': '2020-01-30T17:47:00.0000000Z', 'rate_open': 178.82576830788582, 'rate_high': 178.82576830788582, 'rate_low': 178.82576830788582, 'rate_close': 178.82576830788582}, {'time_period_start': '2020-01-30T17:48:00.0000000Z', 'time_period_end': '2020-01-30T17:49:00.0000000Z', 'time_open': '2020-01-30T17:48:00.0000000Z', 'time_close': '2020-01-30T17:48:00.0000000Z', 'rate_open': 178.8340082968909, 'rate_high': 178.8340082968909, 'rate_low': 178.8340082968909, 'rate_close': 178.8340082968909}, {'time_period_start': '2020-01-30T17:49:00.0000000Z', 'time_period_end': '2020-01-30T17:50:00.0000000Z', 'time_open': '2020-01-30T17:49:00.0000000Z', 'time_close': '2020-01-30T17:49:00.0000000Z', 'rate_open': 178.70547421054664, 'rate_high': 178.70547421054664, 'rate_low': 178.70547421054664, 'rate_close': 178.70547421054664}, {'time_period_start': '2020-01-30T17:50:00.0000000Z', 'time_period_end': '2020-01-30T17:51:00.0000000Z', 'time_open': '2020-01-30T17:50:00.0000000Z', 'time_close': '2020-01-30T17:50:00.0000000Z', 'rate_open': 178.8055223385385, 'rate_high': 178.8055223385385, 'rate_low': 178.8055223385385, 'rate_close': 178.8055223385385}, {'time_period_start': '2020-01-30T17:51:00.0000000Z', 'time_period_end': '2020-01-30T17:52:00.0000000Z', 'time_open': '2020-01-30T17:51:00.0000000Z', 'time_close': '2020-01-30T17:51:00.0000000Z', 'rate_open': 179.26214032196432, 'rate_high': 179.26214032196432, 'rate_low': 179.26214032196432, 'rate_close': 179.26214032196432}, {'time_period_start': '2020-01-30T17:52:00.0000000Z', 'time_period_end': '2020-01-30T17:53:00.0000000Z', 'time_open': '2020-01-30T17:52:00.0000000Z', 'time_close': '2020-01-30T17:52:00.0000000Z', 'rate_open': 179.39310448298946, 'rate_high': 179.39310448298946, 'rate_low': 179.39310448298946, 'rate_close': 179.39310448298946}, {'time_period_start': '2020-01-30T17:53:00.0000000Z', 'time_period_end': '2020-01-30T17:54:00.0000000Z', 'time_open': '2020-01-30T17:53:00.0000000Z', 'time_close': '2020-01-30T17:53:00.0000000Z', 'rate_open': 179.31734675098986, 'rate_high': 179.31734675098986, 'rate_low': 179.31734675098986, 'rate_close': 179.31734675098986}, {'time_period_start': '2020-01-30T17:54:00.0000000Z', 'time_period_end': '2020-01-30T17:55:00.0000000Z', 'time_open': '2020-01-30T17:54:00.0000000Z', 'time_close': '2020-01-30T17:54:00.0000000Z', 'rate_open': 179.10885155304044, 'rate_high': 179.10885155304044, 'rate_low': 179.10885155304044, 'rate_close': 179.10885155304044}, {'time_period_start': '2020-01-30T17:55:00.0000000Z', 'time_period_end': '2020-01-30T17:56:00.0000000Z', 'time_open': '2020-01-30T17:55:00.0000000Z', 'time_close': '2020-01-30T17:55:00.0000000Z', 'rate_open': 179.24861060009513, 'rate_high': 179.24861060009513, 'rate_low': 179.24861060009513, 'rate_close': 179.24861060009513}, {'time_period_start': '2020-01-30T17:56:00.0000000Z', 'time_period_end': '2020-01-30T17:57:00.0000000Z', 'time_open': '2020-01-30T17:56:00.0000000Z', 'time_close': '2020-01-30T17:56:00.0000000Z', 'rate_open': 179.34645317862692, 'rate_high': 179.34645317862692, 'rate_low': 179.34645317862692, 'rate_close': 179.34645317862692}, {'time_period_start': '2020-01-30T17:57:00.0000000Z', 'time_period_end': '2020-01-30T17:58:00.0000000Z', 'time_open': '2020-01-30T17:57:00.0000000Z', 'time_close': '2020-01-30T17:57:00.0000000Z', 'rate_open': 179.23635663980065, 'rate_high': 179.23635663980065, 'rate_low': 179.23635663980065, 'rate_close': 179.23635663980065}, {'time_period_start': '2020-01-30T17:58:00.0000000Z', 'time_period_end': '2020-01-30T17:59:00.0000000Z', 'time_open': '2020-01-30T17:58:00.0000000Z', 'time_close': '2020-01-30T17:58:00.0000000Z', 'rate_open': 179.2376326709775, 'rate_high': 179.2376326709775, 'rate_low': 179.2376326709775, 'rate_close': 179.2376326709775}, {'time_period_start': '2020-01-30T17:59:00.0000000Z', 'time_period_end': '2020-01-30T18:00:00.0000000Z', 'time_open': '2020-01-30T17:59:00.0000000Z', 'time_close': '2020-01-30T17:59:00.0000000Z', 'rate_open': 179.24533852909957, 'rate_high': 179.24533852909957, 'rate_low': 179.24533852909957, 'rate_close': 179.24533852909957}, {'time_period_start': '2020-01-30T18:00:00.0000000Z', 'time_period_end': '2020-01-30T18:01:00.0000000Z', 'time_open': '2020-01-30T18:00:00.0000000Z', 'time_close': '2020-01-30T18:00:00.0000000Z', 'rate_open': 179.34716933887535, 'rate_high': 179.34716933887535, 'rate_low': 179.34716933887535, 'rate_close': 179.34716933887535}, {'time_period_start': '2020-01-30T18:01:00.0000000Z', 'time_period_end': '2020-01-30T18:02:00.0000000Z', 'time_open': '2020-01-30T18:01:00.0000000Z', 'time_close': '2020-01-30T18:01:00.0000000Z', 'rate_open': 179.5132349661227, 'rate_high': 179.5132349661227, 'rate_low': 179.5132349661227, 'rate_close': 179.5132349661227}, {'time_period_start': '2020-01-30T18:02:00.0000000Z', 'time_period_end': '2020-01-30T18:03:00.0000000Z', 'time_open': '2020-01-30T18:02:00.0000000Z', 'time_close': '2020-01-30T18:02:00.0000000Z', 'rate_open': 179.5586230586301, 'rate_high': 179.5586230586301, 'rate_low': 179.5586230586301, 'rate_close': 179.5586230586301}, {'time_period_start': '2020-01-30T18:03:00.0000000Z', 'time_period_end': '2020-01-30T18:04:00.0000000Z', 'time_open': '2020-01-30T18:03:00.0000000Z', 'time_close': '2020-01-30T18:03:00.0000000Z', 'rate_open': 179.48630593646095, 'rate_high': 179.48630593646095, 'rate_low': 179.48630593646095, 'rate_close': 179.48630593646095}, {'time_period_start': '2020-01-30T18:04:00.0000000Z', 'time_period_end': '2020-01-30T18:05:00.0000000Z', 'time_open': '2020-01-30T18:04:00.0000000Z', 'time_close': '2020-01-30T18:04:00.0000000Z', 'rate_open': 179.5694642483396, 'rate_high': 179.5694642483396, 'rate_low': 179.5694642483396, 'rate_close': 179.5694642483396}]
json_data = {}
#json_data = [{'time_period_start': '2021-05-02T17:58:00.0000000Z', 'time_period_end': '2021-05-02T17:59:00.0000000Z', 'time_open': '2021-05-02T17:58:00.0000000Z', 'time_close': '2021-05-02T17:58:00.0000000Z', 'rate_open': 2933.451267134568, 'rate_high': 2933.451267134568, 'rate_low': 2933.451267134568, 'rate_close': 2933.451267134568}, {'time_period_start': '2021-05-02T17:59:00.0000000Z', 'time_period_end': '2021-05-02T18:00:00.0000000Z', 'time_open': '2021-05-02T17:59:00.0000000Z', 'time_close': '2021-05-02T17:59:00.0000000Z', 'rate_open': 2933.6932008266494, 'rate_high': 2933.6932008266494, 'rate_low': 2933.6932008266494, 'rate_close': 2933.6932008266494}, {'time_period_start': '2021-05-02T18:00:00.0000000Z', 'time_period_end': '2021-05-02T18:01:00.0000000Z', 'time_open': '2021-05-02T18:00:00.0000000Z', 'time_close': '2021-05-02T18:00:00.0000000Z', 'rate_open': 2935.0795177462596, 'rate_high': 2935.0795177462596, 'rate_low': 2935.0795177462596, 'rate_close': 2935.0795177462596}, {'time_period_start': '2021-05-02T18:01:00.0000000Z', 'time_period_end': '2021-05-02T18:02:00.0000000Z', 'time_open': '2021-05-02T18:01:00.0000000Z', 'time_close': '2021-05-02T18:01:00.0000000Z', 'rate_open': 2936.062685705147, 'rate_high': 2936.062685705147, 'rate_low': 2936.062685705147, 'rate_close': 2936.062685705147}, {'time_period_start': '2021-05-02T18:02:00.0000000Z', 'time_period_end': '2021-05-02T18:03:00.0000000Z', 'time_open': '2021-05-02T18:02:00.0000000Z', 'time_close': '2021-05-02T18:02:00.0000000Z', 'rate_open': 2935.1149072736966, 'rate_high': 2935.1149072736966, 'rate_low': 2935.1149072736966, 'rate_close': 2935.1149072736966}, {'time_period_start': '2021-05-02T18:03:00.0000000Z', 'time_period_end': '2021-05-02T18:04:00.0000000Z', 'time_open': '2021-05-02T18:03:00.0000000Z', 'time_close': '2021-05-02T18:03:00.0000000Z', 'rate_open': 2933.5194986703036, 'rate_high': 2933.5194986703036, 'rate_low': 2933.5194986703036, 'rate_close': 2933.5194986703036}, {'time_period_start': '2021-05-02T18:04:00.0000000Z', 'time_period_end': '2021-05-02T18:05:00.0000000Z', 'time_open': '2021-05-02T18:04:00.0000000Z', 'time_close': '2021-05-02T18:04:00.0000000Z', 'rate_open': 2931.913678140311, 'rate_high': 2931.913678140311, 'rate_low': 2931.913678140311, 'rate_close': 2931.913678140311}, {'time_period_start': '2021-05-02T18:05:00.0000000Z', 'time_period_end': '2021-05-02T18:06:00.0000000Z', 'time_open': '2021-05-02T18:05:00.0000000Z', 'time_close': '2021-05-02T18:05:00.0000000Z', 'rate_open': 2937.325146697912, 'rate_high': 2937.325146697912, 'rate_low': 2937.325146697912, 'rate_close': 2937.325146697912}, {'time_period_start': '2021-05-02T18:06:00.0000000Z', 'time_period_end': '2021-05-02T18:07:00.0000000Z', 'time_open': '2021-05-02T18:06:00.0000000Z', 'time_close': '2021-05-02T18:06:00.0000000Z', 'rate_open': 2937.1402307839217, 'rate_high': 2937.1402307839217, 'rate_low': 2937.1402307839217, 'rate_close': 2937.1402307839217}, {'time_period_start': '2021-05-02T18:07:00.0000000Z', 'time_period_end': '2021-05-02T18:08:00.0000000Z', 'time_open': '2021-05-02T18:07:00.0000000Z', 'time_close': '2021-05-02T18:07:00.0000000Z', 'rate_open': 2939.7927393261853, 'rate_high': 2939.7927393261853, 'rate_low': 2939.7927393261853, 'rate_close': 2939.7927393261853}, {'time_period_start': '2021-05-02T18:08:00.0000000Z', 'time_period_end': '2021-05-02T18:09:00.0000000Z', 'time_open': '2021-05-02T18:08:00.0000000Z', 'time_close': '2021-05-02T18:08:00.0000000Z', 'rate_open': 2941.6526144391923, 'rate_high': 2941.6526144391923, 'rate_low': 2941.6526144391923, 'rate_close': 2941.6526144391923}, {'time_period_start': '2021-05-02T18:09:00.0000000Z', 'time_period_end': '2021-05-02T18:10:00.0000000Z', 'time_open': '2021-05-02T18:09:00.0000000Z', 'time_close': '2021-05-02T18:09:00.0000000Z', 'rate_open': 2941.367256636116, 'rate_high': 2941.367256636116, 'rate_low': 2941.367256636116, 'rate_close': 2941.367256636116}, {'time_period_start': '2021-05-02T18:10:00.0000000Z', 'time_period_end': '2021-05-02T18:11:00.0000000Z', 'time_open': '2021-05-02T18:10:00.0000000Z', 'time_close': '2021-05-02T18:10:00.0000000Z', 'rate_open': 2940.103342035902, 'rate_high': 2940.103342035902, 'rate_low': 2940.103342035902, 'rate_close': 2940.103342035902}, {'time_period_start': '2021-05-02T18:11:00.0000000Z', 'time_period_end': '2021-05-02T18:12:00.0000000Z', 'time_open': '2021-05-02T18:11:00.0000000Z', 'time_close': '2021-05-02T18:11:00.0000000Z', 'rate_open': 2941.776732944726, 'rate_high': 2941.776732944726, 'rate_low': 2941.776732944726, 'rate_close': 2941.776732944726}, {'time_period_start': '2021-05-02T18:12:00.0000000Z', 'time_period_end': '2021-05-02T18:13:00.0000000Z', 'time_open': '2021-05-02T18:12:00.0000000Z', 'time_close': '2021-05-02T18:12:00.0000000Z', 'rate_open': 2941.9804610619854, 'rate_high': 2941.9804610619854, 'rate_low': 2941.9804610619854, 'rate_close': 2941.9804610619854}, {'time_period_start': '2021-05-02T18:13:00.0000000Z', 'time_period_end': '2021-05-02T18:14:00.0000000Z', 'time_open': '2021-05-02T18:13:00.0000000Z', 'time_close': '2021-05-02T18:13:00.0000000Z', 'rate_open': 2942.3228544050457, 'rate_high': 2942.3228544050457, 'rate_low': 2942.3228544050457, 'rate_close': 2942.3228544050457}, {'time_period_start': '2021-05-02T18:14:00.0000000Z', 'time_period_end': '2021-05-02T18:15:00.0000000Z', 'time_open': '2021-05-02T18:14:00.0000000Z', 'time_close': '2021-05-02T18:14:00.0000000Z', 'rate_open': 2940.6566462954343, 'rate_high': 2940.6566462954343, 'rate_low': 2940.6566462954343, 'rate_close': 2940.6566462954343}, {'time_period_start': '2021-05-02T18:15:00.0000000Z', 'time_period_end': '2021-05-02T18:16:00.0000000Z', 'time_open': '2021-05-02T18:15:00.0000000Z', 'time_close': '2021-05-02T18:15:00.0000000Z', 'rate_open': 2938.4238018009564, 'rate_high': 2938.4238018009564, 'rate_low': 2938.4238018009564, 'rate_close': 2938.4238018009564}, {'time_period_start': '2021-05-02T18:16:00.0000000Z', 'time_period_end': '2021-05-02T18:17:00.0000000Z', 'time_open': '2021-05-02T18:16:00.0000000Z', 'time_close': '2021-05-02T18:16:00.0000000Z', 'rate_open': 2936.654336917332, 'rate_high': 2936.654336917332, 'rate_low': 2936.654336917332, 'rate_close': 2936.654336917332}, {'time_period_start': '2021-05-02T18:17:00.0000000Z', 'time_period_end': '2021-05-02T18:18:00.0000000Z', 'time_open': '2021-05-02T18:17:00.0000000Z', 'time_close': '2021-05-02T18:17:00.0000000Z', 'rate_open': 2937.447741566514, 'rate_high': 2937.447741566514, 'rate_low': 2937.447741566514, 'rate_close': 2937.447741566514}, {'time_period_start': '2021-05-02T18:18:00.0000000Z', 'time_period_end': '2021-05-02T18:19:00.0000000Z', 'time_open': '2021-05-02T18:18:00.0000000Z', 'time_close': '2021-05-02T18:18:00.0000000Z', 'rate_open': 2938.255229705417, 'rate_high': 2938.255229705417, 'rate_low': 2938.255229705417, 'rate_close': 2938.255229705417}, {'time_period_start': '2021-05-02T18:19:00.0000000Z', 'time_period_end': '2021-05-02T18:20:00.0000000Z', 'time_open': '2021-05-02T18:19:00.0000000Z', 'time_close': '2021-05-02T18:19:00.0000000Z', 'rate_open': 2939.0498129739663, 'rate_high': 2939.0498129739663, 'rate_low': 2939.0498129739663, 'rate_close': 2939.0498129739663}, {'time_period_start': '2021-05-02T18:20:00.0000000Z', 'time_period_end': '2021-05-02T18:21:00.0000000Z', 'time_open': '2021-05-02T18:20:00.0000000Z', 'time_close': '2021-05-02T18:20:00.0000000Z', 'rate_open': 2939.6871697832544, 'rate_high': 2939.6871697832544, 'rate_low': 2939.6871697832544, 'rate_close': 2939.6871697832544}, {'time_period_start': '2021-05-02T18:21:00.0000000Z', 'time_period_end': '2021-05-02T18:22:00.0000000Z', 'time_open': '2021-05-02T18:21:00.0000000Z', 'time_close': '2021-05-02T18:21:00.0000000Z', 'rate_open': 2939.301926609266, 'rate_high': 2939.301926609266, 'rate_low': 2939.301926609266, 'rate_close': 2939.301926609266}, {'time_period_start': '2021-05-02T18:22:00.0000000Z', 'time_period_end': '2021-05-02T18:23:00.0000000Z', 'time_open': '2021-05-02T18:22:00.0000000Z', 'time_close': '2021-05-02T18:22:00.0000000Z', 'rate_open': 2941.596365304303, 'rate_high': 2941.596365304303, 'rate_low': 2941.596365304303, 'rate_close': 2941.596365304303}, {'time_period_start': '2021-05-02T18:23:00.0000000Z', 'time_period_end': '2021-05-02T18:24:00.0000000Z', 'time_open': '2021-05-02T18:23:00.0000000Z', 'time_close': '2021-05-02T18:23:00.0000000Z', 'rate_open': 2941.952708361635, 'rate_high': 2941.952708361635, 'rate_low': 2941.952708361635, 'rate_close': 2941.952708361635}, {'time_period_start': '2021-05-02T18:24:00.0000000Z', 'time_period_end': '2021-05-02T18:25:00.0000000Z', 'time_open': '2021-05-02T18:24:00.0000000Z', 'time_close': '2021-05-02T18:24:00.0000000Z', 'rate_open': 2943.2482878913415, 'rate_high': 2943.2482878913415, 'rate_low': 2943.2482878913415, 'rate_close': 2943.2482878913415}, {'time_period_start': '2021-05-02T18:25:00.0000000Z', 'time_period_end': '2021-05-02T18:26:00.0000000Z', 'time_open': '2021-05-02T18:25:00.0000000Z', 'time_close': '2021-05-02T18:25:00.0000000Z', 'rate_open': 2945.6100254897156, 'rate_high': 2945.6100254897156, 'rate_low': 2945.6100254897156, 'rate_close': 2945.6100254897156}, {'time_period_start': '2021-05-02T18:26:00.0000000Z', 'time_period_end': '2021-05-02T18:27:00.0000000Z', 'time_open': '2021-05-02T18:26:00.0000000Z', 'time_close': '2021-05-02T18:26:00.0000000Z', 'rate_open': 2944.285077986811, 'rate_high': 2944.285077986811, 'rate_low': 2944.285077986811, 'rate_close': 2944.285077986811}, {'time_period_start': '2021-05-02T18:27:00.0000000Z', 'time_period_end': '2021-05-02T18:28:00.0000000Z', 'time_open': '2021-05-02T18:27:00.0000000Z', 'time_close': '2021-05-02T18:27:00.0000000Z', 'rate_open': 2941.445412922298, 'rate_high': 2941.445412922298, 'rate_low': 2941.445412922298, 'rate_close': 2941.445412922298}, {'time_period_start': '2021-05-02T18:28:00.0000000Z', 'time_period_end': '2021-05-02T18:29:00.0000000Z', 'time_open': '2021-05-02T18:28:00.0000000Z', 'time_close': '2021-05-02T18:28:00.0000000Z', 'rate_open': 2944.54881637876, 'rate_high': 2944.54881637876, 'rate_low': 2944.54881637876, 'rate_close': 2944.54881637876}, {'time_period_start': '2021-05-02T18:29:00.0000000Z', 'time_period_end': '2021-05-02T18:30:00.0000000Z', 'time_open': '2021-05-02T18:29:00.0000000Z', 'time_close': '2021-05-02T18:29:00.0000000Z', 'rate_open': 2946.3126631565674, 'rate_high': 2946.3126631565674, 'rate_low': 2946.3126631565674, 'rate_close': 2946.3126631565674}, {'time_period_start': '2021-05-02T18:30:00.0000000Z', 'time_period_end': '2021-05-02T18:31:00.0000000Z', 'time_open': '2021-05-02T18:30:00.0000000Z', 'time_close': '2021-05-02T18:30:00.0000000Z', 'rate_open': 2947.6924739603087, 'rate_high': 2947.6924739603087, 'rate_low': 2947.6924739603087, 'rate_close': 2947.6924739603087}, {'time_period_start': '2021-05-02T18:31:00.0000000Z', 'time_period_end': '2021-05-02T18:32:00.0000000Z', 'time_open': '2021-05-02T18:31:00.0000000Z', 'time_close': '2021-05-02T18:31:00.0000000Z', 'rate_open': 2949.0980763986295, 'rate_high': 2949.0980763986295, 'rate_low': 2949.0980763986295, 'rate_close': 2949.0980763986295}, {'time_period_start': '2021-05-02T18:32:00.0000000Z', 'time_period_end': '2021-05-02T18:33:00.0000000Z', 'time_open': '2021-05-02T18:32:00.0000000Z', 'time_close': '2021-05-02T18:32:00.0000000Z', 'rate_open': 2949.2698418678606, 'rate_high': 2949.2698418678606, 'rate_low': 2949.2698418678606, 'rate_close': 2949.2698418678606}, {'time_period_start': '2021-05-02T18:33:00.0000000Z', 'time_period_end': '2021-05-02T18:34:00.0000000Z', 'time_open': '2021-05-02T18:33:00.0000000Z', 'time_close': '2021-05-02T18:33:00.0000000Z', 'rate_open': 2949.977098428699, 'rate_high': 2949.977098428699, 'rate_low': 2949.977098428699, 'rate_close': 2949.977098428699}, {'time_period_start': '2021-05-02T18:34:00.0000000Z', 'time_period_end': '2021-05-02T18:35:00.0000000Z', 'time_open': '2021-05-02T18:34:00.0000000Z', 'time_close': '2021-05-02T18:34:00.0000000Z', 'rate_open': 2950.398412321511, 'rate_high': 2950.398412321511, 'rate_low': 2950.398412321511, 'rate_close': 2950.398412321511}, {'time_period_start': '2021-05-02T18:35:00.0000000Z', 'time_period_end': '2021-05-02T18:36:00.0000000Z', 'time_open': '2021-05-02T18:35:00.0000000Z', 'time_close': '2021-05-02T18:35:00.0000000Z', 'rate_open': 2949.789498904963, 'rate_high': 2949.789498904963, 'rate_low': 2949.789498904963, 'rate_close': 2949.789498904963}, {'time_period_start': '2021-05-02T18:36:00.0000000Z', 'time_period_end': '2021-05-02T18:37:00.0000000Z', 'time_open': '2021-05-02T18:36:00.0000000Z', 'time_close': '2021-05-02T18:36:00.0000000Z', 'rate_open': 2950.5725476740936, 'rate_high': 2950.5725476740936, 'rate_low': 2950.5725476740936, 'rate_close': 2950.5725476740936}, {'time_period_start': '2021-05-02T18:37:00.0000000Z', 'time_period_end': '2021-05-02T18:38:00.0000000Z', 'time_open': '2021-05-02T18:37:00.0000000Z', 'time_close': '2021-05-02T18:37:00.0000000Z', 'rate_open': 2950.712477012242, 'rate_high': 2950.712477012242, 'rate_low': 2950.712477012242, 'rate_close': 2950.712477012242}, {'time_period_start': '2021-05-02T18:38:00.0000000Z', 'time_period_end': '2021-05-02T18:39:00.0000000Z', 'time_open': '2021-05-02T18:38:00.0000000Z', 'time_close': '2021-05-02T18:38:00.0000000Z', 'rate_open': 2948.9482214422005, 'rate_high': 2948.9482214422005, 'rate_low': 2948.9482214422005, 'rate_close': 2948.9482214422005}, {'time_period_start': '2021-05-02T18:39:00.0000000Z', 'time_period_end': '2021-05-02T18:40:00.0000000Z', 'time_open': '2021-05-02T18:39:00.0000000Z', 'time_close': '2021-05-02T18:39:00.0000000Z', 'rate_open': 2950.42515949319, 'rate_high': 2950.42515949319, 'rate_low': 2950.42515949319, 'rate_close': 2950.42515949319}, {'time_period_start': '2021-05-02T18:40:00.0000000Z', 'time_period_end': '2021-05-02T18:41:00.0000000Z', 'time_open': '2021-05-02T18:40:00.0000000Z', 'time_close': '2021-05-02T18:40:00.0000000Z', 'rate_open': 2949.404653741662, 'rate_high': 2949.404653741662, 'rate_low': 2949.404653741662, 'rate_close': 2949.404653741662}, {'time_period_start': '2021-05-02T18:41:00.0000000Z', 'time_period_end': '2021-05-02T18:42:00.0000000Z', 'time_open': '2021-05-02T18:41:00.0000000Z', 'time_close': '2021-05-02T18:41:00.0000000Z', 'rate_open': 2950.4664742142327, 'rate_high': 2950.4664742142327, 'rate_low': 2950.4664742142327, 'rate_close': 2950.4664742142327}, {'time_period_start': '2021-05-02T18:42:00.0000000Z', 'time_period_end': '2021-05-02T18:43:00.0000000Z', 'time_open': '2021-05-02T18:42:00.0000000Z', 'time_close': '2021-05-02T18:42:00.0000000Z', 'rate_open': 2951.4898523461275, 'rate_high': 2951.4898523461275, 'rate_low': 2951.4898523461275, 'rate_close': 2951.4898523461275}, {'time_period_start': '2021-05-02T18:43:00.0000000Z', 'time_period_end': '2021-05-02T18:44:00.0000000Z', 'time_open': '2021-05-02T18:43:00.0000000Z', 'time_close': '2021-05-02T18:43:00.0000000Z', 'rate_open': 2950.807163433381, 'rate_high': 2950.807163433381, 'rate_low': 2950.807163433381, 'rate_close': 2950.807163433381}, {'time_period_start': '2021-05-02T18:44:00.0000000Z', 'time_period_end': '2021-05-02T18:45:00.0000000Z', 'time_open': '2021-05-02T18:44:00.0000000Z', 'time_close': '2021-05-02T18:44:00.0000000Z', 'rate_open': 2950.567007413849, 'rate_high': 2950.567007413849, 'rate_low': 2950.567007413849, 'rate_close': 2950.567007413849}, {'time_period_start': '2021-05-02T18:45:00.0000000Z', 'time_period_end': '2021-05-02T18:46:00.0000000Z', 'time_open': '2021-05-02T18:45:00.0000000Z', 'time_close': '2021-05-02T18:45:00.0000000Z', 'rate_open': 2951.104930767542, 'rate_high': 2951.104930767542, 'rate_low': 2951.104930767542, 'rate_close': 2951.104930767542}, {'time_period_start': '2021-05-02T18:46:00.0000000Z', 'time_period_end': '2021-05-02T18:47:00.0000000Z', 'time_open': '2021-05-02T18:46:00.0000000Z', 'time_close': '2021-05-02T18:46:00.0000000Z', 'rate_open': 2951.445189251755, 'rate_high': 2951.445189251755, 'rate_low': 2951.445189251755, 'rate_close': 2951.445189251755}, {'time_period_start': '2021-05-02T18:47:00.0000000Z', 'time_period_end': '2021-05-02T18:48:00.0000000Z', 'time_open': '2021-05-02T18:47:00.0000000Z', 'time_close': '2021-05-02T18:47:00.0000000Z', 'rate_open': 2953.5219384660863, 'rate_high': 2953.5219384660863, 'rate_low': 2953.5219384660863, 'rate_close': 2953.5219384660863}, {'time_period_start': '2021-05-02T18:48:00.0000000Z', 'time_period_end': '2021-05-02T18:49:00.0000000Z', 'time_open': '2021-05-02T18:48:00.0000000Z', 'time_close': '2021-05-02T18:48:00.0000000Z', 'rate_open': 2952.4098163745216, 'rate_high': 2952.4098163745216, 'rate_low': 2952.4098163745216, 'rate_close': 2952.4098163745216}, {'time_period_start': '2021-05-02T18:49:00.0000000Z', 'time_period_end': '2021-05-02T18:50:00.0000000Z', 'time_open': '2021-05-02T18:49:00.0000000Z', 'time_close': '2021-05-02T18:49:00.0000000Z', 'rate_open': 2952.9942618057194, 'rate_high': 2952.9942618057194, 'rate_low': 2952.9942618057194, 'rate_close': 2952.9942618057194}, {'time_period_start': '2021-05-02T18:50:00.0000000Z', 'time_period_end': '2021-05-02T18:51:00.0000000Z', 'time_open': '2021-05-02T18:50:00.0000000Z', 'time_close': '2021-05-02T18:50:00.0000000Z', 'rate_open': 2955.963332418999, 'rate_high': 2955.963332418999, 'rate_low': 2955.963332418999, 'rate_close': 2955.963332418999}, {'time_period_start': '2021-05-02T18:51:00.0000000Z', 'time_period_end': '2021-05-02T18:52:00.0000000Z', 'time_open': '2021-05-02T18:51:00.0000000Z', 'time_close': '2021-05-02T18:51:00.0000000Z', 'rate_open': 2965.8909662029428, 'rate_high': 2965.8909662029428, 'rate_low': 2965.8909662029428, 'rate_close': 2965.8909662029428}, {'time_period_start': '2021-05-02T18:52:00.0000000Z', 'time_period_end': '2021-05-02T18:53:00.0000000Z', 'time_open': '2021-05-02T18:52:00.0000000Z', 'time_close': '2021-05-02T18:52:00.0000000Z', 'rate_open': 2967.700015919512, 'rate_high': 2967.700015919512, 'rate_low': 2967.700015919512, 'rate_close': 2967.700015919512}, {'time_period_start': '2021-05-02T18:53:00.0000000Z', 'time_period_end': '2021-05-02T18:54:00.0000000Z', 'time_open': '2021-05-02T18:53:00.0000000Z', 'time_close': '2021-05-02T18:53:00.0000000Z', 'rate_open': 2970.6048568430506, 'rate_high': 2970.6048568430506, 'rate_low': 2970.6048568430506, 'rate_close': 2970.6048568430506}, {'time_period_start': '2021-05-02T18:54:00.0000000Z', 'time_period_end': '2021-05-02T18:55:00.0000000Z', 'time_open': '2021-05-02T18:54:00.0000000Z', 'time_close': '2021-05-02T18:54:00.0000000Z', 'rate_open': 2969.122869385991, 'rate_high': 2969.122869385991, 'rate_low': 2969.122869385991, 'rate_close': 2969.122869385991}, {'time_period_start': '2021-05-02T18:55:00.0000000Z', 'time_period_end': '2021-05-02T18:56:00.0000000Z', 'time_open': '2021-05-02T18:55:00.0000000Z', 'time_close': '2021-05-02T18:55:00.0000000Z', 'rate_open': 2965.2534826575247, 'rate_high': 2965.2534826575247, 'rate_low': 2965.2534826575247, 'rate_close': 2965.2534826575247}, {'time_period_start': '2021-05-02T18:56:00.0000000Z', 'time_period_end': '2021-05-02T18:57:00.0000000Z', 'time_open': '2021-05-02T18:56:00.0000000Z', 'time_close': '2021-05-02T18:56:00.0000000Z', 'rate_open': 2970.289198366668, 'rate_high': 2970.289198366668, 'rate_low': 2970.289198366668, 'rate_close': 2970.289198366668}, {'time_period_start': '2021-05-02T18:57:00.0000000Z', 'time_period_end': '2021-05-02T18:58:00.0000000Z', 'time_open': '2021-05-02T18:57:00.0000000Z', 'time_close': '2021-05-02T18:57:00.0000000Z', 'rate_open': 2970.2061680001475, 'rate_high': 2970.2061680001475, 'rate_low': 2970.2061680001475, 'rate_close': 2970.2061680001475}, {'time_period_start': '2021-05-02T18:58:00.0000000Z', 'time_period_end': '2021-05-02T18:59:00.0000000Z', 'time_open': '2021-05-02T18:58:00.0000000Z', 'time_close': '2021-05-02T18:58:00.0000000Z', 'rate_open': 2972.92284215955, 'rate_high': 2972.92284215955, 'rate_low': 2972.92284215955, 'rate_close': 2972.92284215955}]
#json_data = [{'time_period_start': '2021-11-24T00:05:00.0000000Z', 'time_period_end': '2021-11-24T00:06:00.0000000Z', 'time_open': '2021-11-24T00:05:00.0000000Z', 'time_close': '2021-11-24T00:05:00.0000000Z', 'rate_open': 4355.115742904232, 'rate_high': 4355.115742904232, 'rate_low': 4355.115742904232, 'rate_close': 4355.115742904232}, {'time_period_start': '2021-11-24T00:06:00.0000000Z', 'time_period_end': '2021-11-24T00:07:00.0000000Z', 'time_open': '2021-11-24T00:06:00.0000000Z', 'time_close': '2021-11-24T00:06:00.0000000Z', 'rate_open': 4361.11838716714, 'rate_high': 4361.11838716714, 'rate_low': 4361.11838716714, 'rate_close': 4361.11838716714}, {'time_period_start': '2021-11-24T00:07:00.0000000Z', 'time_period_end': '2021-11-24T00:08:00.0000000Z', 'time_open': '2021-11-24T00:07:00.0000000Z', 'time_close': '2021-11-24T00:07:00.0000000Z', 'rate_open': 4358.445267198001, 'rate_high': 4358.445267198001, 'rate_low': 4358.445267198001, 'rate_close': 4358.445267198001}, {'time_period_start': '2021-11-24T00:08:00.0000000Z', 'time_period_end': '2021-11-24T00:09:00.0000000Z', 'time_open': '2021-11-24T00:08:00.0000000Z', 'time_close': '2021-11-24T00:08:00.0000000Z', 'rate_open': 4357.011661710241, 'rate_high': 4357.011661710241, 'rate_low': 4357.011661710241, 'rate_close': 4357.011661710241}, {'time_period_start': '2021-11-24T00:09:00.0000000Z', 'time_period_end': '2021-11-24T00:10:00.0000000Z', 'time_open': '2021-11-24T00:09:00.0000000Z', 'time_close': '2021-11-24T00:09:00.0000000Z', 'rate_open': 4357.680709619391, 'rate_high': 4357.680709619391, 'rate_low': 4357.680709619391, 'rate_close': 4357.680709619391}, {'time_period_start': '2021-11-24T00:10:00.0000000Z', 'time_period_end': '2021-11-24T00:11:00.0000000Z', 'time_open': '2021-11-24T00:10:00.0000000Z', 'time_close': '2021-11-24T00:10:00.0000000Z', 'rate_open': 4360.178913563615, 'rate_high': 4360.178913563615, 'rate_low': 4360.178913563615, 'rate_close': 4360.178913563615}, {'time_period_start': '2021-11-24T00:11:00.0000000Z', 'time_period_end': '2021-11-24T00:12:00.0000000Z', 'time_open': '2021-11-24T00:11:00.0000000Z', 'time_close': '2021-11-24T00:11:00.0000000Z', 'rate_open': 4362.186929131827, 'rate_high': 4362.186929131827, 'rate_low': 4362.186929131827, 'rate_close': 4362.186929131827}, {'time_period_start': '2021-11-24T00:12:00.0000000Z', 'time_period_end': '2021-11-24T00:13:00.0000000Z', 'time_open': '2021-11-24T00:12:00.0000000Z', 'time_close': '2021-11-24T00:12:00.0000000Z', 'rate_open': 4363.9687102707585, 'rate_high': 4363.9687102707585, 'rate_low': 4363.9687102707585, 'rate_close': 4363.9687102707585}, {'time_period_start': '2021-11-24T00:13:00.0000000Z', 'time_period_end': '2021-11-24T00:14:00.0000000Z', 'time_open': '2021-11-24T00:13:00.0000000Z', 'time_close': '2021-11-24T00:13:00.0000000Z', 'rate_open': 4362.439694853292, 'rate_high': 4362.439694853292, 'rate_low': 4362.439694853292, 'rate_close': 4362.439694853292}, {'time_period_start': '2021-11-24T00:14:00.0000000Z', 'time_period_end': '2021-11-24T00:15:00.0000000Z', 'time_open': '2021-11-24T00:14:00.0000000Z', 'time_close': '2021-11-24T00:14:00.0000000Z', 'rate_open': 4360.964460158207, 'rate_high': 4360.964460158207, 'rate_low': 4360.964460158207, 'rate_close': 4360.964460158207}, {'time_period_start': '2021-11-24T00:15:00.0000000Z', 'time_period_end': '2021-11-24T00:16:00.0000000Z', 'time_open': '2021-11-24T00:15:00.0000000Z', 'time_close': '2021-11-24T00:15:00.0000000Z', 'rate_open': 4359.980886100158, 'rate_high': 4359.980886100158, 'rate_low': 4359.980886100158, 'rate_close': 4359.980886100158}, {'time_period_start': '2021-11-24T00:16:00.0000000Z', 'time_period_end': '2021-11-24T00:17:00.0000000Z', 'time_open': '2021-11-24T00:16:00.0000000Z', 'time_close': '2021-11-24T00:16:00.0000000Z', 'rate_open': 4357.25747946882, 'rate_high': 4357.25747946882, 'rate_low': 4357.25747946882, 'rate_close': 4357.25747946882}, {'time_period_start': '2021-11-24T00:17:00.0000000Z', 'time_period_end': '2021-11-24T00:18:00.0000000Z', 'time_open': '2021-11-24T00:17:00.0000000Z', 'time_close': '2021-11-24T00:17:00.0000000Z', 'rate_open': 4355.041629762763, 'rate_high': 4355.041629762763, 'rate_low': 4355.041629762763, 'rate_close': 4355.041629762763}, {'time_period_start': '2021-11-24T00:18:00.0000000Z', 'time_period_end': '2021-11-24T00:19:00.0000000Z', 'time_open': '2021-11-24T00:18:00.0000000Z', 'time_close': '2021-11-24T00:18:00.0000000Z', 'rate_open': 4354.02836316998, 'rate_high': 4354.02836316998, 'rate_low': 4354.02836316998, 'rate_close': 4354.02836316998}, {'time_period_start': '2021-11-24T00:19:00.0000000Z', 'time_period_end': '2021-11-24T00:20:00.0000000Z', 'time_open': '2021-11-24T00:19:00.0000000Z', 'time_close': '2021-11-24T00:19:00.0000000Z', 'rate_open': 4354.290590526699, 'rate_high': 4354.290590526699, 'rate_low': 4354.290590526699, 'rate_close': 4354.290590526699}, {'time_period_start': '2021-11-24T00:20:00.0000000Z', 'time_period_end': '2021-11-24T00:21:00.0000000Z', 'time_open': '2021-11-24T00:20:00.0000000Z', 'time_close': '2021-11-24T00:20:00.0000000Z', 'rate_open': 4353.192800940148, 'rate_high': 4353.192800940148, 'rate_low': 4353.192800940148, 'rate_close': 4353.192800940148}, {'time_period_start': '2021-11-24T00:21:00.0000000Z', 'time_period_end': '2021-11-24T00:22:00.0000000Z', 'time_open': '2021-11-24T00:21:00.0000000Z', 'time_close': '2021-11-24T00:21:00.0000000Z', 'rate_open': 4352.1906163984695, 'rate_high': 4352.1906163984695, 'rate_low': 4352.1906163984695, 'rate_close': 4352.1906163984695}, {'time_period_start': '2021-11-24T00:22:00.0000000Z', 'time_period_end': '2021-11-24T00:23:00.0000000Z', 'time_open': '2021-11-24T00:22:00.0000000Z', 'time_close': '2021-11-24T00:22:00.0000000Z', 'rate_open': 4354.859061006264, 'rate_high': 4354.859061006264, 'rate_low': 4354.859061006264, 'rate_close': 4354.859061006264}, {'time_period_start': '2021-11-24T00:23:00.0000000Z', 'time_period_end': '2021-11-24T00:24:00.0000000Z', 'time_open': '2021-11-24T00:23:00.0000000Z', 'time_close': '2021-11-24T00:23:00.0000000Z', 'rate_open': 4355.913511082244, 'rate_high': 4355.913511082244, 'rate_low': 4355.913511082244, 'rate_close': 4355.913511082244}, {'time_period_start': '2021-11-24T00:24:00.0000000Z', 'time_period_end': '2021-11-24T00:25:00.0000000Z', 'time_open': '2021-11-24T00:24:00.0000000Z', 'time_close': '2021-11-24T00:24:00.0000000Z', 'rate_open': 4355.897556394021, 'rate_high': 4355.897556394021, 'rate_low': 4355.897556394021, 'rate_close': 4355.897556394021}, {'time_period_start': '2021-11-24T00:25:00.0000000Z', 'time_period_end': '2021-11-24T00:26:00.0000000Z', 'time_open': '2021-11-24T00:25:00.0000000Z', 'time_close': '2021-11-24T00:25:00.0000000Z', 'rate_open': 4359.020917989146, 'rate_high': 4359.020917989146, 'rate_low': 4359.020917989146, 'rate_close': 4359.020917989146}, {'time_period_start': '2021-11-24T00:26:00.0000000Z', 'time_period_end': '2021-11-24T00:27:00.0000000Z', 'time_open': '2021-11-24T00:26:00.0000000Z', 'time_close': '2021-11-24T00:26:00.0000000Z', 'rate_open': 4357.71223406914, 'rate_high': 4357.71223406914, 'rate_low': 4357.71223406914, 'rate_close': 4357.71223406914}, {'time_period_start': '2021-11-24T00:27:00.0000000Z', 'time_period_end': '2021-11-24T00:28:00.0000000Z', 'time_open': '2021-11-24T00:27:00.0000000Z', 'time_close': '2021-11-24T00:27:00.0000000Z', 'rate_open': 4352.127500321958, 'rate_high': 4352.127500321958, 'rate_low': 4352.127500321958, 'rate_close': 4352.127500321958}, {'time_period_start': '2021-11-24T00:28:00.0000000Z', 'time_period_end': '2021-11-24T00:29:00.0000000Z', 'time_open': '2021-11-24T00:28:00.0000000Z', 'time_close': '2021-11-24T00:28:00.0000000Z', 'rate_open': 4351.853600186185, 'rate_high': 4351.853600186185, 'rate_low': 4351.853600186185, 'rate_close': 4351.853600186185}, {'time_period_start': '2021-11-24T00:29:00.0000000Z', 'time_period_end': '2021-11-24T00:30:00.0000000Z', 'time_open': '2021-11-24T00:29:00.0000000Z', 'time_close': '2021-11-24T00:29:00.0000000Z', 'rate_open': 4352.904106925324, 'rate_high': 4352.904106925324, 'rate_low': 4352.904106925324, 'rate_close': 4352.904106925324}, {'time_period_start': '2021-11-24T00:30:00.0000000Z', 'time_period_end': '2021-11-24T00:31:00.0000000Z', 'time_open': '2021-11-24T00:30:00.0000000Z', 'time_close': '2021-11-24T00:30:00.0000000Z', 'rate_open': 4353.147445316721, 'rate_high': 4353.147445316721, 'rate_low': 4353.147445316721, 'rate_close': 4353.147445316721}, {'time_period_start': '2021-11-24T00:31:00.0000000Z', 'time_period_end': '2021-11-24T00:32:00.0000000Z', 'time_open': '2021-11-24T00:31:00.0000000Z', 'time_close': '2021-11-24T00:31:00.0000000Z', 'rate_open': 4354.737622036524, 'rate_high': 4354.737622036524, 'rate_low': 4354.737622036524, 'rate_close': 4354.737622036524}, {'time_period_start': '2021-11-24T00:32:00.0000000Z', 'time_period_end': '2021-11-24T00:33:00.0000000Z', 'time_open': '2021-11-24T00:32:00.0000000Z', 'time_close': '2021-11-24T00:32:00.0000000Z', 'rate_open': 4359.677340237604, 'rate_high': 4359.677340237604, 'rate_low': 4359.677340237604, 'rate_close': 4359.677340237604}, {'time_period_start': '2021-11-24T00:33:00.0000000Z', 'time_period_end': '2021-11-24T00:34:00.0000000Z', 'time_open': '2021-11-24T00:33:00.0000000Z', 'time_close': '2021-11-24T00:33:00.0000000Z', 'rate_open': 4361.162601035725, 'rate_high': 4361.162601035725, 'rate_low': 4361.162601035725, 'rate_close': 4361.162601035725}, {'time_period_start': '2021-11-24T00:34:00.0000000Z', 'time_period_end': '2021-11-24T00:35:00.0000000Z', 'time_open': '2021-11-24T00:34:00.0000000Z', 'time_close': '2021-11-24T00:34:00.0000000Z', 'rate_open': 4360.454313809288, 'rate_high': 4360.454313809288, 'rate_low': 4360.454313809288, 'rate_close': 4360.454313809288}, {'time_period_start': '2021-11-24T00:35:00.0000000Z', 'time_period_end': '2021-11-24T00:36:00.0000000Z', 'time_open': '2021-11-24T00:35:00.0000000Z', 'time_close': '2021-11-24T00:35:00.0000000Z', 'rate_open': 4364.093541418947, 'rate_high': 4364.093541418947, 'rate_low': 4364.093541418947, 'rate_close': 4364.093541418947}, {'time_period_start': '2021-11-24T00:36:00.0000000Z', 'time_period_end': '2021-11-24T00:37:00.0000000Z', 'time_open': '2021-11-24T00:36:00.0000000Z', 'time_close': '2021-11-24T00:36:00.0000000Z', 'rate_open': 4366.256673370358, 'rate_high': 4366.256673370358, 'rate_low': 4366.256673370358, 'rate_close': 4366.256673370358}, {'time_period_start': '2021-11-24T00:37:00.0000000Z', 'time_period_end': '2021-11-24T00:38:00.0000000Z', 'time_open': '2021-11-24T00:37:00.0000000Z', 'time_close': '2021-11-24T00:37:00.0000000Z', 'rate_open': 4367.4276534293285, 'rate_high': 4367.4276534293285, 'rate_low': 4367.4276534293285, 'rate_close': 4367.4276534293285}, {'time_period_start': '2021-11-24T00:38:00.0000000Z', 'time_period_end': '2021-11-24T00:39:00.0000000Z', 'time_open': '2021-11-24T00:38:00.0000000Z', 'time_close': '2021-11-24T00:38:00.0000000Z', 'rate_open': 4369.603205272666, 'rate_high': 4369.603205272666, 'rate_low': 4369.603205272666, 'rate_close': 4369.603205272666}, {'time_period_start': '2021-11-24T00:39:00.0000000Z', 'time_period_end': '2021-11-24T00:40:00.0000000Z', 'time_open': '2021-11-24T00:39:00.0000000Z', 'time_close': '2021-11-24T00:39:00.0000000Z', 'rate_open': 4371.709266267442, 'rate_high': 4371.709266267442, 'rate_low': 4371.709266267442, 'rate_close': 4371.709266267442}, {'time_period_start': '2021-11-24T00:40:00.0000000Z', 'time_period_end': '2021-11-24T00:41:00.0000000Z', 'time_open': '2021-11-24T00:40:00.0000000Z', 'time_close': '2021-11-24T00:40:00.0000000Z', 'rate_open': 4370.332427817656, 'rate_high': 4370.332427817656, 'rate_low': 4370.332427817656, 'rate_close': 4370.332427817656}, {'time_period_start': '2021-11-24T00:41:00.0000000Z', 'time_period_end': '2021-11-24T00:42:00.0000000Z', 'time_open': '2021-11-24T00:41:00.0000000Z', 'time_close': '2021-11-24T00:41:00.0000000Z', 'rate_open': 4369.77340132683, 'rate_high': 4369.77340132683, 'rate_low': 4369.77340132683, 'rate_close': 4369.77340132683}, {'time_period_start': '2021-11-24T00:42:00.0000000Z', 'time_period_end': '2021-11-24T00:43:00.0000000Z', 'time_open': '2021-11-24T00:42:00.0000000Z', 'time_close': '2021-11-24T00:42:00.0000000Z', 'rate_open': 4369.168431703576, 'rate_high': 4369.168431703576, 'rate_low': 4369.168431703576, 'rate_close': 4369.168431703576}, {'time_period_start': '2021-11-24T00:43:00.0000000Z', 'time_period_end': '2021-11-24T00:44:00.0000000Z', 'time_open': '2021-11-24T00:43:00.0000000Z', 'time_close': '2021-11-24T00:43:00.0000000Z', 'rate_open': 4365.5545134456, 'rate_high': 4365.5545134456, 'rate_low': 4365.5545134456, 'rate_close': 4365.5545134456}, {'time_period_start': '2021-11-24T00:44:00.0000000Z', 'time_period_end': '2021-11-24T00:45:00.0000000Z', 'time_open': '2021-11-24T00:44:00.0000000Z', 'time_close': '2021-11-24T00:44:00.0000000Z', 'rate_open': 4363.589896228044, 'rate_high': 4363.589896228044, 'rate_low': 4363.589896228044, 'rate_close': 4363.589896228044}, {'time_period_start': '2021-11-24T00:45:00.0000000Z', 'time_period_end': '2021-11-24T00:46:00.0000000Z', 'time_open': '2021-11-24T00:45:00.0000000Z', 'time_close': '2021-11-24T00:45:00.0000000Z', 'rate_open': 4363.383269241631, 'rate_high': 4363.383269241631, 'rate_low': 4363.383269241631, 'rate_close': 4363.383269241631}, {'time_period_start': '2021-11-24T00:46:00.0000000Z', 'time_period_end': '2021-11-24T00:47:00.0000000Z', 'time_open': '2021-11-24T00:46:00.0000000Z', 'time_close': '2021-11-24T00:46:00.0000000Z', 'rate_open': 4362.083175887256, 'rate_high': 4362.083175887256, 'rate_low': 4362.083175887256, 'rate_close': 4362.083175887256}, {'time_period_start': '2021-11-24T00:47:00.0000000Z', 'time_period_end': '2021-11-24T00:48:00.0000000Z', 'time_open': '2021-11-24T00:47:00.0000000Z', 'time_close': '2021-11-24T00:47:00.0000000Z', 'rate_open': 4357.920899091703, 'rate_high': 4357.920899091703, 'rate_low': 4357.920899091703, 'rate_close': 4357.920899091703}, {'time_period_start': '2021-11-24T00:48:00.0000000Z', 'time_period_end': '2021-11-24T00:49:00.0000000Z', 'time_open': '2021-11-24T00:48:00.0000000Z', 'time_close': '2021-11-24T00:48:00.0000000Z', 'rate_open': 4358.111278523672, 'rate_high': 4358.111278523672, 'rate_low': 4358.111278523672, 'rate_close': 4358.111278523672}, {'time_period_start': '2021-11-24T00:49:00.0000000Z', 'time_period_end': '2021-11-24T00:50:00.0000000Z', 'time_open': '2021-11-24T00:49:00.0000000Z', 'time_close': '2021-11-24T00:49:00.0000000Z', 'rate_open': 4357.312727646015, 'rate_high': 4357.312727646015, 'rate_low': 4357.312727646015, 'rate_close': 4357.312727646015}, {'time_period_start': '2021-11-24T00:50:00.0000000Z', 'time_period_end': '2021-11-24T00:51:00.0000000Z', 'time_open': '2021-11-24T00:50:00.0000000Z', 'time_close': '2021-11-24T00:50:00.0000000Z', 'rate_open': 4350.6969925198555, 'rate_high': 4350.6969925198555, 'rate_low': 4350.6969925198555, 'rate_close': 4350.6969925198555}, {'time_period_start': '2021-11-24T00:51:00.0000000Z', 'time_period_end': '2021-11-24T00:52:00.0000000Z', 'time_open': '2021-11-24T00:51:00.0000000Z', 'time_close': '2021-11-24T00:51:00.0000000Z', 'rate_open': 4350.842850505649, 'rate_high': 4350.842850505649, 'rate_low': 4350.842850505649, 'rate_close': 4350.842850505649}, {'time_period_start': '2021-11-24T00:52:00.0000000Z', 'time_period_end': '2021-11-24T00:53:00.0000000Z', 'time_open': '2021-11-24T00:52:00.0000000Z', 'time_close': '2021-11-24T00:52:00.0000000Z', 'rate_open': 4350.856188912736, 'rate_high': 4350.856188912736, 'rate_low': 4350.856188912736, 'rate_close': 4350.856188912736}, {'time_period_start': '2021-11-24T00:53:00.0000000Z', 'time_period_end': '2021-11-24T00:54:00.0000000Z', 'time_open': '2021-11-24T00:53:00.0000000Z', 'time_close': '2021-11-24T00:53:00.0000000Z', 'rate_open': 4350.867525899047, 'rate_high': 4350.867525899047, 'rate_low': 4350.867525899047, 'rate_close': 4350.867525899047}, {'time_period_start': '2021-11-24T00:54:00.0000000Z', 'time_period_end': '2021-11-24T00:55:00.0000000Z', 'time_open': '2021-11-24T00:54:00.0000000Z', 'time_close': '2021-11-24T00:54:00.0000000Z', 'rate_open': 4351.044194479684, 'rate_high': 4351.044194479684, 'rate_low': 4351.044194479684, 'rate_close': 4351.044194479684}, {'time_period_start': '2021-11-24T00:55:00.0000000Z', 'time_period_end': '2021-11-24T00:56:00.0000000Z', 'time_open': '2021-11-24T00:55:00.0000000Z', 'time_close': '2021-11-24T00:55:00.0000000Z', 'rate_open': 4358.534886926589, 'rate_high': 4358.534886926589, 'rate_low': 4358.534886926589, 'rate_close': 4358.534886926589}, {'time_period_start': '2021-11-24T00:56:00.0000000Z', 'time_period_end': '2021-11-24T00:57:00.0000000Z', 'time_open': '2021-11-24T00:56:00.0000000Z', 'time_close': '2021-11-24T00:56:00.0000000Z', 'rate_open': 4358.522361141462, 'rate_high': 4358.522361141462, 'rate_low': 4358.522361141462, 'rate_close': 4358.522361141462}, {'time_period_start': '2021-11-24T00:57:00.0000000Z', 'time_period_end': '2021-11-24T00:58:00.0000000Z', 'time_open': '2021-11-24T00:57:00.0000000Z', 'time_close': '2021-11-24T00:57:00.0000000Z', 'rate_open': 4357.192511417259, 'rate_high': 4357.192511417259, 'rate_low': 4357.192511417259, 'rate_close': 4357.192511417259}, {'time_period_start': '2021-11-24T00:58:00.0000000Z', 'time_period_end': '2021-11-24T00:59:00.0000000Z', 'time_open': '2021-11-24T00:58:00.0000000Z', 'time_close': '2021-11-24T00:58:00.0000000Z', 'rate_open': 4354.9960265352765, 'rate_high': 4354.9960265352765, 'rate_low': 4354.9960265352765, 'rate_close': 4354.9960265352765}, {'time_period_start': '2021-11-24T00:59:00.0000000Z', 'time_period_end': '2021-11-24T01:00:00.0000000Z', 'time_open': '2021-11-24T00:59:00.0000000Z', 'time_close': '2021-11-24T00:59:00.0000000Z', 'rate_open': 4354.1890645818685, 'rate_high': 4354.1890645818685, 'rate_low': 4354.1890645818685, 'rate_close': 4354.1890645818685}, {'time_period_start': '2021-11-24T01:00:00.0000000Z', 'time_period_end': '2021-11-24T01:01:00.0000000Z', 'time_open': '2021-11-24T01:00:00.0000000Z', 'time_close': '2021-11-24T01:00:00.0000000Z', 'rate_open': 4350.15575051064, 'rate_high': 4350.15575051064, 'rate_low': 4350.15575051064, 'rate_close': 4350.15575051064}, {'time_period_start': '2021-11-24T01:01:00.0000000Z', 'time_period_end': '2021-11-24T01:02:00.0000000Z', 'time_open': '2021-11-24T01:01:00.0000000Z', 'time_close': '2021-11-24T01:01:00.0000000Z', 'rate_open': 4349.440398178, 'rate_high': 4349.440398178, 'rate_low': 4349.440398178, 'rate_close': 4349.440398178}, {'time_period_start': '2021-11-24T01:02:00.0000000Z', 'time_period_end': '2021-11-24T01:03:00.0000000Z', 'time_open': '2021-11-24T01:02:00.0000000Z', 'time_close': '2021-11-24T01:02:00.0000000Z', 'rate_open': 4352.203129623753, 'rate_high': 4352.203129623753, 'rate_low': 4352.203129623753, 'rate_close': 4352.203129623753}, {'time_period_start': '2021-11-24T01:03:00.0000000Z', 'time_period_end': '2021-11-24T01:04:00.0000000Z', 'time_open': '2021-11-24T01:03:00.0000000Z', 'time_close': '2021-11-24T01:03:00.0000000Z', 'rate_open': 4355.186146259869, 'rate_high': 4355.186146259869, 'rate_low': 4355.186146259869, 'rate_close': 4355.186146259869}, {'time_period_start': '2021-11-24T01:04:00.0000000Z', 'time_period_end': '2021-11-24T01:05:00.0000000Z', 'time_open': '2021-11-24T01:04:00.0000000Z', 'time_close': '2021-11-24T01:04:00.0000000Z', 'rate_open': 4356.700591449531, 'rate_high': 4356.700591449531, 'rate_low': 4356.700591449531, 'rate_close': 4356.700591449531}, {'time_period_start': '2021-11-24T01:05:00.0000000Z', 'time_period_end': '2021-11-24T01:06:00.0000000Z', 'time_open': '2021-11-24T01:05:00.0000000Z', 'time_close': '2021-11-24T01:05:00.0000000Z', 'rate_open': 4356.753777309049, 'rate_high': 4356.753777309049, 'rate_low': 4356.753777309049, 'rate_close': 4356.753777309049}]
logging.info('Script is started')
#conn = psycopg2.connect(host='localhost', dbname='ether', user='ether', password='ether', port=5432)
conn = psycopg2.connect(host=os.getenv('dbhost'), dbname=os.getenv('dbname'), user=os.getenv('dbuser'), password=os.getenv('dbpwd'), port=os.getenv('dbport'))
logging.info("Database connected successfully!")
#process_transactions()
process_file(csvfilename)
conn.close()